# JFIF转JPG工具站项目开发规则

## 项目概述

本项目是一个面向海外用户的在线JFIF转JPG图片格式转换工具站，采用GitHub+Cloudflare技术栈，提供高效、安全、可扩展的图片格式转换服务。

## 技术架构规范

### 1. 前端技术栈
- **框架**: React 18 + TypeScript
- **构建工具**: Vite
- **UI框架**: Tailwind CSS + Headless UI
- **状态管理**: Zustand
- **部署平台**: Cloudflare Pages

### 2. 后端技术栈
- **运行时**: Cloudflare Workers
- **语言**: JavaScript/TypeScript
- **框架**: Hono
- **存储**: Cloudflare R2

### 3. 开发环境要求
- Node.js >= 18.0.0
- npm >= 8.0.0
- Git >= 2.30.0
- Wrangler CLI (Cloudflare Workers开发工具)

## 代码规范

### 1. 文件命名规范
- **组件文件**: PascalCase (如 `FileUpload.tsx`)
- **工具函数**: camelCase (如 `imageConverter.ts`)
- **类型定义**: PascalCase (如 `ConversionTypes.ts`)
- **常量文件**: UPPER_SNAKE_CASE (如 `API_ENDPOINTS.ts`)

### 2. 代码风格规范
- 使用ESLint + Prettier进行代码格式化
- 遵循TypeScript严格模式
- 使用2个空格缩进
- 行尾分号必须
- 字符串使用单引号
- 对象属性使用简写语法

### 3. 组件开发规范
```typescript
// 组件结构示例
interface ComponentProps {
  // 属性定义
}

export const Component: React.FC<ComponentProps> = ({ prop1, prop2 }) => {
  // 状态定义
  // 副作用处理
  // 事件处理
  
  return (
    // JSX结构
  );
};
```

### 4. API接口规范
- 使用RESTful API设计原则
- 统一响应格式
- 错误码标准化
- 请求参数验证

## 项目结构规范

### 1. 前端目录结构
```
src/
├── components/          # 可复用组件
│   ├── FileUpload/     # 文件上传组件
│   ├── ImagePreview/   # 图片预览组件
│   ├── Conversion/     # 转换控制组件
│   └── Settings/       # 高级设置组件
├── pages/              # 页面组件
├── hooks/              # 自定义Hooks
├── utils/              # 工具函数
├── types/              # TypeScript类型定义
├── constants/          # 常量定义
└── styles/             # 样式文件
```

### 2. 后端目录结构
```
src/
├── workers/            # Workers函数
├── utils/              # 工具函数
├── types/              # 类型定义
├── constants/          # 常量定义
└── middleware/         # 中间件
```

## 开发流程规范

### 1. Git工作流
- 使用Git Flow分支模型
- 主分支: `main` (生产环境)
- 开发分支: `develop` (开发环境)
- 功能分支: `feature/功能名称`
- 修复分支: `hotfix/问题描述`

### 2. 提交信息规范
```
类型(范围): 简短描述

详细描述（可选）

关联问题: #123
```

**类型说明**:
- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动

### 3. 代码审查规范
- 所有代码必须通过Pull Request
- 至少1名团队成员审查
- 通过所有自动化测试
- 符合代码规范要求

## 功能开发规范

### 1. 文件上传功能
- 支持拖拽上传和点击上传
- 文件类型验证: JFIF, JPG, PNG, BMP, GIF, WebP
- 文件大小限制: 单文件10MB，总大小100MB
- 实时文件预览和信息显示

### 2. 图片转换功能
- 支持JFIF转JPG和其他格式互转
- 批量转换支持（最多20个文件）
- 转换参数可配置（质量、尺寸、压缩等）
- 实时转换进度显示

### 3. 用户体验功能
- 响应式设计，支持PC/平板/手机
- 深色/浅色主题切换
- 多语言支持（英语为主）
- 快捷键支持

## 性能优化规范

### 1. 前端性能
- 页面加载时间 < 3秒
- 图片懒加载
- 代码分割和按需加载
- 静态资源CDN加速

### 2. 后端性能
- API响应时间 < 2秒
- 支持1000+并发用户
- 图片处理优化
- 缓存策略

### 3. 存储优化
- 文件压缩算法优化
- 临时文件24小时自动清理
- 预签名URL安全访问

## 安全规范

### 1. 文件安全
- 严格的文件类型验证
- 恶意文件检测
- 文件内容安全检查
- 临时存储策略

### 2. 访问控制
- API限流控制
- CORS策略配置
- 预签名URL访问
- HTTPS强制加密

### 3. 隐私保护
- 用户数据最小化收集
- 自动数据清理机制
- GDPR合规性
- 隐私政策透明

## 部署规范

### 1. 环境配置
- 开发环境: `.env.development`
- 生产环境: `.env.production`
- 敏感信息通过环境变量注入
- 配置文件不包含敏感数据

### 2. 自动化部署
- 使用GitHub Actions进行CI/CD
- 代码提交自动触发构建
- 自动化测试和部署
- 环境隔离和配置管理

### 3. 监控和告警
- 性能监控指标
- 错误率监控
- 用户行为分析
- 系统可用性监控

## 测试规范

### 1. 单元测试
- 使用Jest进行单元测试
- 测试覆盖率 > 80%
- 核心功能100%测试覆盖
- Mock外部依赖

### 2. 集成测试
- API接口测试
- 组件集成测试
- 端到端测试
- 性能测试

### 3. 测试环境
- 开发环境测试
- 预生产环境测试
- 生产环境监控

## SEO优化规范

### 1. 技术SEO
- 页面加载速度优化
- 移动端友好性
- HTTPS安全协议
- 网站地图和robots.txt

### 2. 内容SEO
- 关键词优化策略
- 结构化数据标记
- 内部链接建设
- 内容更新策略

### 3. 用户体验SEO
- 页面停留时间优化
- 跳出率控制
- 用户行为分析

## 质量保证规范

### 1. 代码质量
- 使用TypeScript严格模式
- ESLint规则强制执行
- 代码复杂度控制
- 重复代码检测

### 2. 文档要求
- README.md项目说明
- API文档
- 组件使用说明
- 部署指南

### 3. 版本管理
- 语义化版本号
- 更新日志维护
- 向后兼容性考虑

## 应急响应规范

### 1. 问题报告
- 问题严重程度分级
- 问题报告模板
- 响应时间要求
- 升级流程

### 2. 故障处理
- 故障分类和处理流程
- 回滚策略
- 数据恢复方案
- 用户通知机制

## 合规性要求

### 1. 法律合规
- 隐私政策
- 服务条款
- 数据保护法规
- 版权声明

### 2. 技术标准
- Web标准遵循
- 可访问性标准
- 安全标准
- 性能标准

## 维护和更新

### 1. 定期维护
- 依赖包更新
- 安全补丁应用
- 性能优化
- 功能增强

### 2. 用户反馈
- 反馈收集机制
- 问题跟踪系统
- 功能需求评估
- 用户满意度调查

---

**注意**: 本规则文件是项目开发的基础规范，所有团队成员必须严格遵守。如有疑问或建议，请及时提出并讨论更新。 